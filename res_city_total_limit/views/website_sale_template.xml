<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="payment" inherit_id="website_sale.payment" name="Payment">
        <xpath expr="//div[@class='card']" position="before">
            <h3 class="mb24">Информация об общей сумме заказов с вашего населенного пункта</h3>
            <div class="card">
                <div class="card-body">
                    <div>
                        <div>С Вашего населенного пункта набралось заказов на: <span style="color: #28a745" t-esc='order.partner_id.city_id.total' t-options='{"widget": "monetary", "display_currency": website_sale_order.pricelist_id.currency_id}'/></div>
                        <div>Для бесплатной доставки необходимо: <span style="color: #28a745" t-esc='order.partner_id.city_id.limit' t-options='{"widget": "monetary", "display_currency": website_sale_order.pricelist_id.currency_id}' class="address-inline"/></div>
                        <div>Ожидаемое время набора: <span class="font-weight-bold" t-esc='order.partner_id.city_id.expected_delivery_time'/><span class="font-weight-bold"> дней</span></div>
                    </div>
                </div>
            </div>
            <div class="oe_structure clearfix mt-3"/>
        </xpath>
    </template>

    <template id="assets_frontend" inherit_id="website.assets_frontend" name="City Total Limit">
        <xpath expr="." position="inside">
            <link rel="stylesheet" href="/res_city_total_limit/static/src/css/main.css"/>
        </xpath>
    </template>

    <template id="product" name="Product" inherit_id="website_sale.products">
        <xpath expr="//div[@id='oe_structure_website_sale_products_1']" position="after">
            <t t-call="res_city_total_limit.total_city_limit"/>
        </xpath>
    </template>

    <template name="Total City Limit" id="total_city_limit">
        <t t-set="current_user" t-value="request.env.user"/>
        <t t-if="website.user_id != user_id and current_user.partner_id.city_id">
            <section class="total_limit_snippet">
                <h3>С вашего населенного пункта набралось заказов на <span style="color: #28a745"><t t-esc='current_user.partner_id.city_id.total' t-options='{"widget": "monetary", "display_currency": website.currency_id}'/></span> из <span style="color: #28a745"><t t-esc='current_user.partner_id.city_id.limit' t-options='{"widget": "monetary", "display_currency": website.currency_id}'/></span></h3>
            </section>
        </t>
    </template>
</odoo>
