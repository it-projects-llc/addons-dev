<?xml version="1.0" encoding="utf-8"?>
<odoo>

<template id="registration_attendee_details" inherit_id="website_event.registration_attendee_details">

    <xpath expr="//t[@t-foreach='tickets']/div[@class='row']" position="replace">
        <div class="row" t-if="event.use_attendees_header">
            <t t-foreach="event.attendee_field_ids" t-as="field">
                <div t-attf-class="col-md-{{field.width}}"><strong t-raw="field.field_description"/><t t-if="not field.is_required"> <span class="text-muted">(Optional)</span></t></div>
            </t>
        </div>
    </xpath>

    <xpath expr="//t[@t-as='att_counter']/div[@class='row mb4']" position="replace">
        <div class="row" t-att-style="att_counter_odd and 'background-color:#E7E7E7'">
            <t t-set="attendee_placeholder">[Attendee #%s] </t>
            <t t-set="autofill_user" t-value="counter==1 and env.user"/>
            <t t-foreach="event.attendee_field_ids" t-as="field">
                <t t-set="field_value" t-value="autofill_user and field.get_value(autofill_user.partner_id) or ''"/>
                <div t-attf-class="col-md-{{field.width}} mb8 mt8">
                    
                    <strong t-if="not event.use_attendees_header"><t t-esc="field.field_description"/><t t-if="not field.is_required"> <span class="text-muted">(Optional)</span></t></strong>
                    <t t-if="field.form_type in ['many2one']">
                        <select
                            class="form-control"
                            t-attf-name="#{counter}-#{field.field_name}"
                            t-att-required="field.is_required and 'This field is required' or ''"
                            >
                            <option value=""><t t-esc="field.field_description"/>...</option>
                            <t t-foreach="field.get_select_options()" t-as="s">
                                <option
                                    t-att-value="s['id']"
                                    t-att-selected="field_value == s['id'] and '1'"
                                    >
                                    <t t-esc="s['name']" />
                                </option>
                            </t>
                        </select>
                    </t>
                    <t t-else="">
                        <input
                            class='form-control'
                            t-att-type='field.form_type'
                            t-att-value="field_value"
                            t-attf-name="#{counter}-#{field.field_name}"
                            t-att-required="field.is_required and 'This field is required' or ''"
                            t-att-placeholder="(attendee_placeholder and (attendee_placeholder %counter) or '')"/>
                        <t t-set="attendee_placeholder"></t>
                    </t>
                </div>
            </t>
            <input class='hidden' type='text' t-attf-name="#{counter}-ticket_id" t-attf-value="#{ticket['id']}"/>
        </div>
    </xpath>
</template>

</odoo>
